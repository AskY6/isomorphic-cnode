webpackJsonp([3],{88:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,a){try{var i=t[o](a),c=i.value}catch(u){return void n(u)}return i.done?void e(c):Promise.resolve(c).then((function(e){r("next",e)}),(function(e){r("throw",e)}))}return r("next")})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e){var t=e.state,n=e.handlers,r=(t.alertText,t.loadingText,n.handleLogin);return f["default"].createElement(h["default"],null,f["default"].createElement("section",{className:"page-body"},f["default"].createElement("div",{className:"label"},f["default"].createElement(p.Input,{name:"token",className:"txt",type:"text",placeholder:"Access Token",maxLength:"36"})),f["default"].createElement("div",{className:"label"},f["default"].createElement("button",{className:"button",onClick:r},"登录"))))}Object.defineProperty(t,"__esModule",{value:!0});var l=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(2),f=r(s),p=n(58),d=n(70),h=r(d),b=n(38),m=r(b),v=(function(e){function t(){var e,n,r,c,l=this;a(this,t);for(var s=arguments.length,f=Array(s),p=0;p<s;p++)f[p]=arguments[p];return n=r=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(f))),r.View=u,r.initialState={pageTitle:"登录",token:""},r.handleLogin=o(regeneratorRuntime.mark((function d(){var e,t,n,o,a,i;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(e=r,t=e.context,n=r.store.getState(),o=n.token,a=n.location,o&&36===o.length){c.next=5;break}return r.showAlert("令牌格式错误, 应为36位UUID字符串"),c.abrupt("return");case 5:return r.showLoading("登录中……"),c.prev=6,c.next=9,r.fetchUserInfo(o);case 9:if(i=c.sent){c.next=12;break}throw new Error("登陆失败，请重试");case 12:r.cookie("accesstoken",o),window.location.reload(),c.next=19;break;case 16:c.prev=16,c.t0=c["catch"](6),r.showAlert(c.t0.message);case 19:r.hideLoading();case 20:case"end":return c.stop()}}),d,l,[[6,16]])}))),c=n,i(r,c)}return c(t,e),l(t,[{key:"shouldComponentCreate",value:function(){var e=this.context,t=this.location;if(this.isLogin()){var n=e.userInfo,r=t.query.redirect;return r||(r=e.basename+"/user/"+n.loginname),this.redirect(r),!1}}}]),t})(m["default"]);t["default"]=v}});